<!DOCTYPE html>
<html lang="en-US">
<head>
  	<title>Mat McLoughlin</title>

  	<meta charset="UTF-8" />
  	<meta name="viewport" content="width=device-width" />
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0" />
	<meta name="description" content=".Net developer and lover of javascript. This blog contains my thoughts and ramblings.">
	<meta name="author" content="Mathew McLoughlin">
  
	<link rel="shortcut icon" href="/images/favicon.ico" />

  	<link href="" rel="alternate" title="" type="application/atom+xml">
  
	<link rel='stylesheet' href='/stylesheets/style.css' type='text/css' media='all' />
	<link rel='stylesheet' href='/stylesheets/includes/fonts/fontawesome/font-awesome.css' type='text/css' media='screen' />
	<link rel='stylesheet' href='/stylesheets/media-queries.css' type='text/css' media='screen' />
	<link rel='stylesheet' href='/stylesheets/pygments.css' type='text/css' media='screen' />

	<style type="text/css">
		a, #cancel-comment-reply i {
			color: rgba(0,83,159,0.65);
		}

		.next-prev a, #respond .respond-submit, .wpcf7-submit, .header .search-form .submit, .search-form .submit { 
			background: rgba(0,83,159,1);
		}

		.infinite-scroll #infinite-handle {
			overflow: auto;
		}
	</style>

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css' />
	<link rel='stylesheet' id='google-raleway-css'  href='http://fonts.googleapis.com/css?family=Raleway%3A300%2C500%2C700%2C800&#038;ver=3.6.1' type='text/css' media='all' />
	<script type="text/javascript" src="http://codeorigin.jquery.com/jquery-1.10.2.min.js"></script>
</head>
<body class="home blog infinite-scroll"> 
	<header role="banner" class="header"> 
		<hgroup>
			<h1 class="logo-text">
				<a href="/" title="Mat McLoughlin">Mat McLoughlin</a>
			</h1>
			<h2 class="logo-subtitle">A calm sea does not make a skilled sailor</h2> 
		</hgroup> 
  		<nav role="navigation" class="header-nav"> 
  			<ul id="menu-header" class="nav">
    			<li id="menu-item-blog">
      				<a href="/">Blog</a>
    			</li>
    			<li id="menu-item-talks">
      				<a href="/talks.html">Talks</a>
    			</li>
    			<li id="menu-item-archive">
  					<a href="/archives.html">Archive</a>
    			</li>
  			</ul>
		</nav>
	</header>
	<div id="wrapper">
		<div id="main">
			<div id="content">
				<style type="text/css">
.nav #menu-item-blog a {
    color: #fff;
}
</style>

<div class="posts">
    <article class="post" style="margin-bottom: 0;"> 
        
            <a class="featured-image grayscale" href="/2013/09/15/aspnet-youre-doing-it-wrong-views.html" title="ASP.NET you're doing it wrong. Part Two: The Views">
                <img width="1400" height="600" src="/images/posts/nancy.png" class="attachment-large-image" alt="{ page.title }}" />
            </a>
        

        <div class="box-wrap">
            <div class="box"> 
                <header class="post-header">
                    <div class="date-title">15 September, 2013</div>
                    <h2 class="entry-title">
                        <a href="http://mat-mcloughlin.net/2013/09/15/aspnet-youre-doing-it-wrong-views.html" title="ASP.NET you're doing it wrong. Part Two: The Views">ASP.NET you're doing it wrong. Part Two: The Views</a>
                    </h2> 
                </header>
                <div class="post-content">
                    <p>In my previous post I spoke briefly about how to setup routes and handle route arguments etc. In this post I’m going to run through the various options you have for returning and presenting your data in views. If you haven’t already I suggest you read the <a href="/2013/08/20/aspnet-youre-doing-it-wrong-an-introduction-to-nancy.html">first part</a> of this series.</p>

<h2 id="returning_views_and_the_convention">Returning views and the Convention</h2>

<p>Just as a refresher, a simple get method that returns a string, is defined as follows:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>_</span> <span class='p'>=&gt;</span> <span class='p'>{</span>
<span class='lineno'>2</span>     <span class='k'>return</span> <span class='s'>&quot;Hello World!&quot;</span>
<span class='lineno'>3</span> <span class='p'>};</span>
</code></pre></div>
<p>To change this to return a view instead is easy. The <code>NancyModule</code> base class has a property of type <code>ViewRenderer</code> called <code>View</code>. This is like the Route handlers in that it is an indexer. It allows you to set the view you wish to return in a number of different ways. As a basic example:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>_</span> <span class='p'>=&gt;</span> <span class='p'>{</span>
<span class='lineno'>2</span>     <span class='k'>return</span> <span class='n'>View</span><span class='p'>[</span><span class='s'>&quot;Hello.html&quot;</span><span class='p'>]</span>
<span class='lineno'>3</span> <span class='p'>};</span>
</code></pre></div>
<p>This will process and return a view in a file called <code>Hello.html</code>.</p>

<p>When Nancy sees that you want to return <code>Hello.html</code> it will look in a number of different places for the file. First it will look in the root of your application. If it can’t find it there it will look in a directory called <code>Views</code> and finally if it can’t find it there it will look in folder of the same name as the module that you are returning the view from. That is to say, if your module is called <code>TurtlesModule</code> it will look for the folder <code>Views\Turtles</code> (Note: the module portion is removed). If it can’t find the view in that folder it will throw an error.</p>

<p>The error is one of the things I really like about Nancy. It’s actually useful. I know right?! Here’s a screen shot:</p>

<p><img src="/images/posts/missing-view.jpg" alt="Missing View" /></p>

<p>If you look on the line that starts “Locations inspected” you can see every place that Nancy has looked for the view. Making it really easy to find the problem.</p>

<p>Now it is possible to change this convention, as it with everything in Nancy, but I will talk about that more when I cover the <code>Bootstrapper</code> class in a future post.</p>

<h2 id="alternative_methods_of_returning_a_view">Alternative Methods of Returning a View</h2>

<p>The astute among you many have noticed I’m only returning some plain html. What if I want to return a view model as well. Nancy allows you to do this in two different ways. The first is to specify it as the second argument in the indexer:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>_</span> <span class='p'>=&gt;</span> <span class='p'>{</span>
<span class='lineno'>2</span>     <span class='k'>return</span> <span class='n'>View</span><span class='p'>[</span><span class='s'>&quot;Hello.html&quot;</span><span class='p'>,</span> <span class='k'>new</span> <span class='n'>HelloModel</span><span class='p'>()]</span>
<span class='lineno'>3</span> <span class='p'>};</span>
</code></pre></div>
<p>and the second is a little bit more interesting. You can actually just specify the model:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>_</span> <span class='p'>=&gt;</span> <span class='p'>{</span>
<span class='lineno'>2</span>     <span class='k'>return</span> <span class='n'>View</span><span class='p'>[</span><span class='k'>new</span> <span class='n'>HelloModel</span><span class='p'>()]</span>
<span class='lineno'>3</span> <span class='p'>};</span>
</code></pre></div>
<p>If you do this Nancy will then attempt to find a view in a file called <code>Hello.html</code> (Removing the Model part) in the same fashion as above. I’ve got to be honest, I’m not a fan of this method. I’d much rather be explicit about the view and the model.</p>

<h2 id="the_super_simple_view_engine_and_other_options">The Super Simple View Engine and other options</h2>

<p>So returning a view is one thing. Chances are you want to do something dynamic with the view model though. Nancy ships with the Super Simple View Engine (I’m going to refer to this as SSVE from now on to save my <a href="http://www.keysleft.com/">keystrokes</a>). This is, as the name would suggest, simple. If you are wanting to do anything remotely complicated I would recommend using Nancy’s implementation of the Razor view engine. But just to show you an example of the syntax:</p>
<div class='highlight'><pre><code class='html'><span class='lineno'> 1</span> <span class='nt'>&lt;h1&gt;</span>Hello Turtles!<span class='nt'>&lt;/h1&gt;</span>
<span class='lineno'> 2</span> <span class='nt'>&lt;table</span> <span class='na'>border=</span><span class='s'>&quot;1&quot;</span><span class='nt'>&gt;</span>
<span class='lineno'> 3</span>     <span class='nt'>&lt;tr&gt;</span>
<span class='lineno'> 4</span>         <span class='nt'>&lt;th&gt;</span>Name<span class='nt'>&lt;/th&gt;</span>
<span class='lineno'> 5</span>         <span class='nt'>&lt;th&gt;</span>Mask Colour<span class='nt'>&lt;/th&gt;</span>
<span class='lineno'> 6</span>     <span class='nt'>&lt;/tr&gt;</span>
<span class='lineno'> 7</span>     @Each.Model
<span class='lineno'> 8</span>     <span class='nt'>&lt;tr&gt;</span>
<span class='lineno'> 9</span>         <span class='nt'>&lt;td&gt;&lt;a</span> <span class='na'>href=</span><span class='s'>&quot;/turtles/details/@Current.Id&quot;</span><span class='nt'>&gt;</span>@Current.Name<span class='nt'>&lt;/a&gt;&lt;/td&gt;</span>
<span class='lineno'>10</span>         <span class='nt'>&lt;td&gt;</span>@Current.MaskColour<span class='nt'>&lt;/td&gt;</span>
<span class='lineno'>11</span>     <span class='nt'>&lt;/tr&gt;</span>
<span class='lineno'>12</span>     @EndEach
<span class='lineno'>13</span> <span class='nt'>&lt;/table&gt;</span>
</code></pre></div>
<p>It has all the usual iterators and conditionals that you would expect. However, one thing to bear in mind is it cannot handle nested loops. So be aware.</p>

<p>Did I say how extensible Nancy is? :D</p>

<p>If the SSVE isn’t good enough for you there are plenty of other options all available by <a href="http://www.nuget.org/packages?q=nancy.viewengines">nuget</a> packages. And for the most part they are easy to install and configure. As an example see <a href="https://github.com/NancyFx/Nancy/wiki/Razor-View-Engine">this</a> wiki page. I should point out that this is not the ASP.NET implementation of Razor so you may notice some inconsistencies in what methods are available.</p>

<h2 id="bonus_points">Bonus Points</h2>

<ul>
<li>When attempting to locate a view Nancy will look for files with the extension .html or .htm or .sshtml. You don’t have to specify the extension when defining the view to return. SSVE will try and parse all of these files.</li>

<li>In this day and age you probably want to be able to handle different accept headers. <a href="https://twitter.com/philliphaydon">@philiphaydon</a> has written a great <a href="http://www.philliphaydon.com/2013/04/nancyfx-revisiting-content-negotiation-and-apis-part-1/">series</a> of posts example on how to do this.</li>
</ul>

<p>I think thats about it for views. Next post will be about the <code>Bootstrapper</code> class which is where Nancy really starts to show its extensibility.</p>
                </div>
                <ul class="meta">
                    <div class="meta-title">Share</div>
                    <li>
                        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://mat-mcloughlin.net/2013/09/15/aspnet-youre-doing-it-wrong-views.html" data-text="ASP.NET you're doing it wrong. Part Two: The Views" data-via="mat_mcloughlin">Tweet</a>
                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                    </li>
                    <li> 
                        <a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
                        <script>(function(d, t) { var g = d.createElement(t), s = d.getElementsByTagName(t)[0]; g.src = '//hnbutton.appspot.com/static/hn.min.js'; s.parentNode.insertBefore(g, s); }(document, 'script'));</script>
                        </li>
                        <li>
                            <div class="g-plusone" data-size="medium" data-annotation="inline" data-width="300"></div>
                            <script type="text/javascript">(function() { var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = 'https://apis.google.com/js/plusone.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s); })();</script>
                        </li>
                        <li>
                            <div class="fb-like" data-href="http://mat-mcloughlin.net/2013/09/15/aspnet-youre-doing-it-wrong-views.html" data-width="450" data-layout="button_count" data-show-faces="true" data-send="false"></div>
                            <div id="fb-root"></div>
                            <script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script>
                        </li>
                        <li class="next-prev-mobile">&nbsp;</li>
                        <li class="prev-mobile next-prev-mobile">
                            <a href="http://themes.okaythemes.com/pocket/2012/10/01/bart-goes-under-the-bay/" rel="prev"><i class="icon-arrow-left"></i> Previous Post</a>
                        </li>
                        <li class="next-prev-mobile">
                            <a href="http://themes.okaythemes.com/pocket/2012/10/01/a-trip-to-the-san-francisco-bay/" rel="next"><i class="icon-arrow-right"></i> Next Post</a>
                        </li>
                    </ul>
                </div>
            </div> 
        </div>
    </article>
</div>

<div id="comment-jump" class="comments"><div id="comments">
        <div class="comments-wrap">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'invalidargblog'; // required: replace example with your forum shortname

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>
</div>

<div class="next-prev">
    
        <div class="prev-post"> 
            <a href="/2013/08/29/my-first-talk-and-what-I-learnt.html" rel="prev">Previous Post</a>
        </div>
    
    
        <div class="next-post"> 
            <a href="/2013/09/21/running-jekyll-on-windows.html" rel="next">Next Post</a>
        </div>
    
</div>


			</div>
		</div>
	</div>
	<footer id="footer">
		<div id="footer-inside">
			<div id="text-2" class="widget widget_text">
				<h2 class="widgettitle">Mathew McLoughlin</h2>
				<div class="textwidget">Net developer and lover of javascript. I enjoy climbing and surfing (in cold water). Powered by Beard.</div>
			</div>
			<div id="recent-posts-3" class="widget widget_recent_entries">
				<h2 class="widgettitle">Recent Posts</h2>
				<ul>
					
						<li><a href="/2013/12/24/chocolatey-the-schema-version-is-incompatible.html" title="Chocolatey: The schema version is incompatible" title="Chocolatey: The schema version is incompatible">Chocolatey: The schema version is incompatible</a></li>
					
						<li><a href="/2013/12/12/this-code-is-bad-and-you-should-feel-bad.html" title="This Code is Bad and you should feel Bad" title="This Code is Bad and you should feel Bad">This Code is Bad and you should feel Bad</a></li>
					
						<li><a href="/2013/12/01/twelve-achivements-to-unlock.html" title="12 life achievements to unlock" title="12 life achievements to unlock">12 life achievements to unlock</a></li>
					
				</ul>
			</div>
			<div id="archives-2" class="widget widget_archive">
				<h2 class="widgettitle">Social Links</h2>
				<ul>
					<li>
						<i class="icon-twitter"></i> <a href="https://twitter.com/mat_mcloughlin" title="Twitter">Twitter</a></li>
					<li>
						<i class="icon-github"></i> <a href="https://github.com/mat-mcloughlin" title="GitHub">GitHub</a>
					</li>
					<li>
						<i class="icon-rss"></i> <a href="/rss.xml" title="August 2012">RSS</a>
					</li>
				</ul>
			</div>
		</div> 
	</footer>
	
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-1746767-6']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
</body>
</html>