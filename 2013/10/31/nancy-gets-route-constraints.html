<!DOCTYPE html>
<html lang="en-US">
<head>
  	<title>Mat McLoughlin</title>

  	<meta charset="UTF-8" />
  	<meta name="viewport" content="width=device-width" />
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0" />
	<meta name="description" content=".Net developer and lover of javascript. This blog contains my thoughts and ramblings.">
	<meta name="author" content="Mathew McLoughlin">
  
	<link rel="shortcut icon" href="/images/favicon.ico" />

  	<link href="" rel="alternate" title="" type="application/atom+xml">
  
	<link rel='stylesheet' href='/stylesheets/style.css' type='text/css' media='all' />
	<link rel='stylesheet' href='/stylesheets/includes/fonts/fontawesome/font-awesome.css' type='text/css' media='screen' />
	<link rel='stylesheet' href='/stylesheets/media-queries.css' type='text/css' media='screen' />
	<link rel='stylesheet' href='/stylesheets/pygments.css' type='text/css' media='screen' />

	<style type="text/css">
		a, #cancel-comment-reply i {
			color: rgba(0,83,159,0.65);
		}

		.next-prev a, #respond .respond-submit, .wpcf7-submit, .header .search-form .submit, .search-form .submit { 
			background: rgba(0,83,159,1);
		}

		.infinite-scroll #infinite-handle {
			overflow: auto;
		}
	</style>

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css' />
	<link rel='stylesheet' id='google-raleway-css'  href='http://fonts.googleapis.com/css?family=Raleway%3A300%2C500%2C700%2C800&#038;ver=3.6.1' type='text/css' media='all' />
	<script type="text/javascript" src="http://codeorigin.jquery.com/jquery-1.10.2.min.js"></script>
</head>
<body class="home blog infinite-scroll"> 
	<header role="banner" class="header"> 
		<hgroup>
			<h1 class="logo-text">
				<a href="/" title="Mat McLoughlin">Mat McLoughlin</a>
			</h1>
			<h2 class="logo-subtitle">A calm sea does not make a skilled sailor</h2> 
		</hgroup> 
  		<nav role="navigation" class="header-nav"> 
  			<ul id="menu-header" class="nav">
    			<li id="menu-item-blog">
      				<a href="/">Blog</a>
    			</li>
    			<li id="menu-item-talks">
      				<a href="/talks.html">Talks</a>
    			</li>
    			<li id="menu-item-archive">
  					<a href="/archives.html">Archive</a>
    			</li>
  			</ul>
		</nav>
	</header>
	<div id="wrapper">
		<div id="main">
			<div id="content">
				<style type="text/css">
.nav #menu-item-blog a {
    color: #fff;
}
</style>

<div class="posts">
    <article class="post" style="margin-bottom: 0;"> 
        

        <div class="box-wrap">
            <div class="box"> 
                <header class="post-header">
                    <div class="date-title">31 October, 2013</div>
                    <h2 class="entry-title">
                        <a href="http://mat-mcloughlin.net/2013/10/31/nancy-gets-route-constraints.html" title="Nancy gets Route Constraints (Beta Only)">Nancy gets Route Constraints (Beta Only)</a>
                    </h2> 
                </header>
                <div class="post-content">
                    <p>A couple of people have been after this for a while so I thought I would implement it. This update will give Nancy the ability to have routes that are only called if the parameter of the route fits certain criteria.</p>

<p>The format for the constraints has been copied from the recent WebAPI release. Its really easy to use. All you have to do is define the parameter name and the constraint as part of the route. For example:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/{name:string}&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>parameters</span> <span class='p'>=&gt;</span> <span class='k'>return</span> <span class='n'>parameters</span><span class='p'>.</span><span class='n'>Name</span> <span class='p'>+</span> <span class='s'>&quot; is a string&quot;</span><span class='p'>;</span>
</code></pre></div>
<p>This isn’t in the prod version of Nancy yet but you can get hold of it in the <a href="https://www.myget.org/gallery/nancyfx">NancyFX bleeding edge builds</a> nuget package</p>

<p>The constraints available to you are:</p>
<table>
	<tr>
		<th>Constraint</th>
		<th>Description</th>
	</tr>
	<tr>
		<td><code>{value:int}</code></td>
		<td>Must be an integer value (long is used so any size int can be used_</td>
	</tr>
	<tr>
		<td><code>{value:decimal}</code></td>
		<td>Must be have decimal place</td>
	</tr>
	<tr>
		<td><code>{value:guid}</code></td>
		<td>Must be a GUID</td>
	</tr>
	<tr>
		<td><code>{value:bool}</code></td>
		<td>Must be either true or false</td>
	</tr>
	<tr>
		<td><code>{value:alpha}</code></td>
		<td>Must contain only alpha characters</td>
	</tr>
	<tr>
		<td><code>{value:datetime}</code></td>
		<td>Must be date time formatted string</td>
	</tr>
	<tr>
		<td><code>{value:min(n)}</code></td>
		<td>Must be a numeric greater than <i>n</i>	</td>
	</tr>
	<tr>
		<td><code>{value:max(n)}</code></td>
		<td>Must be numeric less than <i>n</i></td>
	</tr>
	<tr>
		<td><code>{value:range(n,m)}</code></td>
		<td>Must be a numeric between <i>n</i> and <i>m</i></td>
	</tr>
	<tr>
		<td><code>{value:minlength(n)}</code></td>
		<td>Must be string of length greater than <i>n</i></td>
	</tr>
	<tr>
		<td><code>{value:maxlength(n)}</code></td>
		<td>Must be string of length less than <i>n</i></td>
	</tr>
	<tr>
		<td><code>{value:length(n,m)}</code></td>
		<td>Must be string of length between <i>n</i> and <i>m</i></td>
	</tr>
</table>
<p>If you’ve looked at the WebAPI implementation of this you may have noticed there are some other options such as <em>long</em> and <em>float</em> that are not included here. I don’t think these are really necessary as distinguishing between them isn’t really useful for route paramters. better to just have <em>int</em> and <em>decimal</em>. However I will point out that <code>{value:int}</code> does use long so that any size of integer can be used.</p>

<p>As an example to where this is useful. Imagine you want the same route to find a product, but you want to allow a user to use a product id or a product name. The following example will allow you to do that:</p>
<div class='highlight'><pre><code class='csharp'><span class='lineno'>1</span> <span class='k'>public</span> <span class='k'>class</span> <span class='nc'>ProductModule</span> <span class='p'>:</span> <span class='n'>NancyModule</span> <span class='p'>{</span>
<span class='lineno'>2</span>     <span class='k'>public</span> <span class='nf'>ProductModule</span><span class='p'>(</span><span class='n'>IProductRepository</span> <span class='n'>productRepository</span><span class='p'>)</span>
<span class='lineno'>3</span>     <span class='p'>{</span> 
<span class='lineno'>4</span>         <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/product/{name:alpha}&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>parameter</span> <span class='p'>=&gt;</span> <span class='n'>productRepository</span><span class='p'>.</span><span class='n'>GetProductByName</span><span class='p'>(</span><span class='n'>parameter</span><span class='p'>.</span><span class='n'>Name</span><span class='p'>);</span>
<span class='lineno'>5</span> 
<span class='lineno'>6</span>         <span class='n'>Get</span><span class='p'>[</span><span class='s'>&quot;/product/{id:int}&quot;</span><span class='p'>]</span> <span class='p'>=</span> <span class='n'>parameter</span> <span class='p'>=&gt;</span> <span class='n'>productRepository</span><span class='p'>.</span><span class='n'>GetProductById</span><span class='p'>(</span><span class='n'>parameter</span><span class='p'>.</span><span class='n'>Id</span><span class='p'>);</span>
<span class='lineno'>7</span>     <span class='p'>}</span>
<span class='lineno'>8</span> <span class='p'>}</span> 
</code></pre></div>
<p>I’ll let you know when this comes out of beta.</p>
                </div>
                <ul class="meta">
                    <div class="meta-title">Share</div>
                    <li>
                        <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://mat-mcloughlin.net/2013/10/31/nancy-gets-route-constraints.html" data-text="Nancy gets Route Constraints (Beta Only)" data-via="mat_mcloughlin">Tweet</a>
                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                    </li>
                    <li> 
                        <a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
                        <script>(function(d, t) { var g = d.createElement(t), s = d.getElementsByTagName(t)[0]; g.src = '//hnbutton.appspot.com/static/hn.min.js'; s.parentNode.insertBefore(g, s); }(document, 'script'));</script>
                        </li>
                        <li>
                            <div class="g-plusone" data-size="medium" data-annotation="inline" data-width="300"></div>
                            <script type="text/javascript">(function() { var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = 'https://apis.google.com/js/plusone.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s); })();</script>
                        </li>
                        <li>
                            <div class="fb-like" data-href="http://mat-mcloughlin.net/2013/10/31/nancy-gets-route-constraints.html" data-width="450" data-layout="button_count" data-show-faces="true" data-send="false"></div>
                            <div id="fb-root"></div>
                            <script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script>
                        </li>
                        <li class="next-prev-mobile">&nbsp;</li>
                        <li class="prev-mobile next-prev-mobile">
                            <a href="http://themes.okaythemes.com/pocket/2012/10/01/bart-goes-under-the-bay/" rel="prev"><i class="icon-arrow-left"></i> Previous Post</a>
                        </li>
                        <li class="next-prev-mobile">
                            <a href="http://themes.okaythemes.com/pocket/2012/10/01/a-trip-to-the-san-francisco-bay/" rel="next"><i class="icon-arrow-right"></i> Next Post</a>
                        </li>
                    </ul>
                </div>
            </div> 
        </div>
    </article>
</div>

<div id="comment-jump" class="comments"><div id="comments">
        <div class="comments-wrap">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'invalidargblog'; // required: replace example with your forum shortname

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>
</div>

<div class="next-prev">
    
        <div class="prev-post"> 
            <a href="/2013/10/02/why-developers-should-go-to-conferences.html" rel="prev">Previous Post</a>
        </div>
    
    
        <div class="next-post"> 
            <a href="/2013/11/02/step-away-from-the-keyboard.html" rel="next">Next Post</a>
        </div>
    
</div>


			</div>
		</div>
	</div>
	<footer id="footer">
		<div id="footer-inside">
			<div id="text-2" class="widget widget_text">
				<h2 class="widgettitle">Mathew McLoughlin</h2>
				<div class="textwidget">Net developer and lover of javascript. I enjoy climbing and surfing (in cold water). Powered by Beard.</div>
			</div>
			<div id="recent-posts-3" class="widget widget_recent_entries">
				<h2 class="widgettitle">Recent Posts</h2>
				<ul>
					
						<li><a href="/2013/12/24/chocolatey-the-schema-version-is-incompatible.html" title="Chocolatey: The schema version is incompatible" title="Chocolatey: The schema version is incompatible">Chocolatey: The schema version is incompatible</a></li>
					
						<li><a href="/2013/12/12/this-code-is-bad-and-you-should-feel-bad.html" title="This Code is Bad and you should feel Bad" title="This Code is Bad and you should feel Bad">This Code is Bad and you should feel Bad</a></li>
					
						<li><a href="/2013/12/01/twelve-achivements-to-unlock.html" title="12 life achievements to unlock" title="12 life achievements to unlock">12 life achievements to unlock</a></li>
					
				</ul>
			</div>
			<div id="archives-2" class="widget widget_archive">
				<h2 class="widgettitle">Social Links</h2>
				<ul>
					<li>
						<i class="icon-twitter"></i> <a href="https://twitter.com/mat_mcloughlin" title="Twitter">Twitter</a></li>
					<li>
						<i class="icon-github"></i> <a href="https://github.com/mat-mcloughlin" title="GitHub">GitHub</a>
					</li>
					<li>
						<i class="icon-rss"></i> <a href="/rss.xml" title="August 2012">RSS</a>
					</li>
				</ul>
			</div>
		</div> 
	</footer>
	
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-1746767-6']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
</body>
</html>